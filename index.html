<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wordle Game</title>

    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <header>
        <div class="logo">Wordle</div>
    </header>
    <div class="content">

            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>


            <div class="keyboard">
                <div class="keyboard-row">
                    <button type="button" value="q" class="key" onclick="addLetter(this.value)">q</button>
                    <button type="button" value="w" class="key" onclick="addLetter(this.value)">w</button>
                    <button type="button" value="e" class="key" onclick="addLetter(this.value)">e</button>
                    <button type="button" value="r" class="key" onclick="addLetter(this.value)">r</button>
                    <button type="button" value="t" class="key" onclick="addLetter(this.value)">t</button>
                    <button type="button" value="y" class="key" onclick="addLetter(this.value)">y</button>
                    <button type="button" value="u" class="key" onclick="addLetter(this.value)">u</button>
                    <button type="button" value="i" class="key" onclick="addLetter(this.value)">i</button>
                    <button type="button" value="o" class="key" onclick="addLetter(this.value)">o</button>
                    <button type="button" value="p" class="key" onclick="addLetter(this.value)">p</button>
                </div>
                <div class="keyboard-row">
                    <button type="button" value="a" class="key" onclick="addLetter(this.value)">a</button>
                    <button type="button" value="s" class="key" onclick="addLetter(this.value)">s</button>
                    <button type="button" value="d" class="key" onclick="addLetter(this.value)">d</button>
                    <button type="button" value="f" class="key" onclick="addLetter(this.value)">f</button>
                    <button type="button" value="g" class="key" onclick="addLetter(this.value)">g</button>
                    <button type="button" value="h" class="key" onclick="addLetter(this.value)">h</button>
                    <button type="button" value="j" class="key" onclick="addLetter(this.value)">j</button>
                    <button type="button" value="k" class="key" onclick="addLetter(this.value)">k</button>
                    <button type="button" value="l" class="key" onclick="addLetter(this.value)">l</button>
                </div>
                <div class="keyboard-row">
                    <button type="button" class="key key--wide" onclick="submitWord()">Enter</button>
                    <button type="button" value="e" class="key" onclick="addLetter(this.value)">e</button>
                    <button type="button" value="z" class="key" onclick="addLetter(this.value)">z</button>
                    <button type="button" value="x" class="key" onclick="addLetter(this.value)">x</button>
                    <button type="button" value="c" class="key" onclick="addLetter(this.value)">c</button>
                    <button type="button" value="v" class="key" onclick="addLetter(this.value)">v</button>
                    <button type="button" value="b" class="key" onclick="addLetter(this.value)">b</button>
                    <button type="button" value="n" class="key" onclick="addLetter(this.value)">n</button>
                    <button type="button" value="m" class="key" onclick="addLetter(this.value)">m</button>
                    <button type="button" class="key key--wide" onclick="backspace()">BACK</button>

                </div>
            </div>


    </div>
</div>

</body>
<script>

    let word ='';
    let inputWord = '';
    let attempts = 0;
    const MAX_ATTEMPTS = 6;
    const WORD_LENGTH = 5;
    const wordLetters = document.querySelectorAll('.tile');
    const WORDS =['kamil'];
    let isGuessed = new Array(WORD_LENGTH).fill(0);

    function generateWord(){
        word = WORDS[Math.floor(Math.random()*WORDS.length)];
        console.log(word);
    }


    function addLetter(val) {
        if (inputWord.length < WORD_LENGTH) {
            inputWord += val;
            wordLetters[attempts * WORD_LENGTH + inputWord.length - 1].innerHTML = val.toUpperCase();
            console.log(inputWord === word);
        }
    }
    function backspace() {
        if (inputWord.length >= 1) {
            wordLetters[attempts * WORD_LENGTH + inputWord.length - 1].innerHTML = "";
            inputWord = inputWord.slice(0, inputWord.length - 1);
            console.log(inputWord);
        }
    }
    function resetWord(){
        attempts = 0;
        generateWord();
        wordLetters.forEach((letter) =>{
            letter.style.backgroundColor = "#131314";
            letter.style.color = '#fff';
            letter.innerHTML = "";
        })
    }

    function submitWord() {

        if (inputWord.length !== WORD_LENGTH){
            alert(`Pleas enter a word with ${WORD_LENGTH} letters`);
            return;
        }

        const letterMatches = [];

        for(let i = 0; i < WORD_LENGTH; i++){
            let letter = inputWord[i];
            wordLetters[WORD_LENGTH * attempts + i].innerHTML = letter.toUpperCase();
            if(word.includes(letter)){
                if (word[i] === letter) {
                    wordLetters[WORD_LENGTH * attempts + i].style.backgroundColor = '#4CAF50';
                    wordLetters[WORD_LENGTH * attempts + i].style.color = '#fff';
                    isGuessed[i] = 1;
                } else {
                    letterMatches.push([letter,i]);
                }
            }
            else{
                //todo
            }
        }
        console.log(letterMatches);
        console.log(word);

        for (let i = 0; i < letterMatches.length; i++){
            let letter = letterMatches[i][0];
            let letter_idx = letterMatches[i][1];
            let idx = word.indexOf(letter);
            while (idx !== -1) {
                if (isGuessed[idx] === 0){
                    isGuessed[idx] = 2;
                    wordLetters[WORD_LENGTH * attempts + letter_idx].style.backgroundColor = '#ffcc00'
                    wordLetters[WORD_LENGTH * attempts + letter_idx].style.color = '#000';
                    break;
                }
                idx = word.indexOf(letter, idx + 1);
            }
        }
        attempts += 1;
        document.getElementById('attempts').innerHTML = `Attempts: ${attempts}`;
        isGuessed.fill(0);

        if (word === inputWord){
            alert(`You won in ${attempts} attempts`);
            resetWord();
        }
        else if (attempts === MAX_ATTEMPTS){
            alert(`You lost! To many attempts!\nThe word was ${word}`);
            resetWord();
        }
        inputWord = '';

    }
    generateWord();
</script>
</html>
