<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wordle Game</title>

    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <header>
<!--        <div class="burger"></div>-->
        <div class="logo">Wordle</div>
<!--        <div class="utilities"></div>-->
    </header>
    <div class="content">

            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>
            <div class="row">
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
                <div class="tile"></div>
            </div>


            <div class="keyboard">
                <div class="keyborad-row">
                    <button type="button" data-key="q" class="key">q</button>
                    <button type="button" data-key="w" class="key">w</button>
                    <button type="button" data-key="e" class="key">e</button>
                    <button type="button" data-key="r" class="key">r</button>
                    <button type="button" data-key="t" class="key">t</button>
                    <button type="button" data-key="y" class="key">y</button>
                    <button type="button" data-key="u" class="key">u</button>
                    <button type="button" data-key="i" class="key">i</button>
                    <button type="button" data-key="o" class="key">o</button>
                    <button type="button" data-key="p" class="key">p</button>
                </div>
                <div class="keyborad-row">
                    <button type="button" data-key="a" class="key">a</button>
                    <button type="button" data-key="s" class="key">s</button>
                    <button type="button" data-key="d" class="key">d</button>
                    <button type="button" data-key="f" class="key">f</button>
                    <button type="button" data-key="g" class="key">g</button>
                    <button type="button" data-key="h" class="key">h</button>
                    <button type="button" data-key="j" class="key">j</button>
                    <button type="button" data-key="k" class="key">k</button>
                    <button type="button" data-key="l" class="key">l</button>
                </div>
                <div class="keyborad-row">
                    <button type="button" data-key="" class="key">enter</button>
                    <button type="button" data-key="z" class="key">z</button>
                    <button type="button" data-key="x" class="key">x</button>
                    <button type="button" data-key="c" class="key">c</button>
                    <button type="button" data-key="v" class="key">v</button>
                    <button type="button" data-key="b" class="key">b</button>
                    <button type="button" data-key="n" class="key">n</button>
                    <button type="button" data-key="m" class="key">m</button>
                    <button type="button" data-key="m" class="key">backspace</button>

                </div>
                <div class="keyborad-row">
                    <label>
                        <input class="input-field" type="text" id="word-input" maxlength="5" placeholder="Enter a word">
                    </label>
                    <button class="submit-button" onclick="submitWord()">Submit</button>
                </div>
            </div>


    </div>
    <div class="attempts" id="attempts">Attempts: 0</div>

</div>

</body>
<script>

    let word ='';
    let attempts = 0;
    const MAX_ATTEMPTS = 6;
    const WORD_LENGTH = 5;
    const wordLetters = document.querySelectorAll('.tile');
    const WORDS =["kamil"];
    let isGuessed = new Array(WORD_LENGTH).fill(0);

    function generateWord(){
        word = WORDS[Math.floor(Math.random()*WORDS.length)];
        console.log(word);
    }

    function resetWord(){
        attempts = 0;
        generateWord();
        wordLetters.forEach((letter) =>{
            letter.style.backgroundColor = "#131314";
            letter.style.color = '#fff';
            letter.innerHTML = "";
        })
        document.getElementById("attempts").innerHTML = "Attempts: 0";
        document.getElementById("word-input").value = '';

    }

    function end(inputWord){
        if (word === inputWord){
            alert(`You won in ${attempts} attempts`);
            resetWord();
        }
        else if (attempts === MAX_ATTEMPTS){
            alert(`You lost! To many attempts!\nThe word was ${word}`);
            resetWord();
        }
    }
    function submitWord() {
        const inputWord = document.getElementById("word-input").value.toLowerCase();
        if (inputWord.length !== WORD_LENGTH){
            alert(`Pleas enter a word with ${WORD_LENGTH} letters`);
            return;
        }

        const letterMatches = [];

        for(let i = 0; i < WORD_LENGTH; i++){
            let letter = inputWord[i];
            wordLetters[WORD_LENGTH * attempts + i].innerHTML = letter.toUpperCase();
            if(word.includes(letter)){
                if (word[i] === letter) {
                    wordLetters[WORD_LENGTH * attempts + i].style.backgroundColor = '#4CAF50';
                    wordLetters[WORD_LENGTH * attempts + i].style.color = '#fff';
                    isGuessed[i] = 1;
                } else {
                    letterMatches.push([letter,i]);
                }
            }
            else{
                //todo
            }
        }
        console.log(letterMatches);
        console.log(word);

        for (let i = 0; i < letterMatches.length; i++){
            let letter = letterMatches[i][0];
            let letter_idx = letterMatches[i][1];
            let idx = word.indexOf(letter);
            while (idx !== -1) {
                if (isGuessed[idx] === 0){
                    isGuessed[idx] = 2;
                    wordLetters[WORD_LENGTH * attempts + letter_idx].style.backgroundColor = '#ffcc00'
                    wordLetters[WORD_LENGTH * attempts + letter_idx].style.color = '#000';
                    break;
                }
                idx = word.indexOf(letter, idx + 1);
            }
        }
        attempts += 1;
        document.getElementById('attempts').innerHTML = `Attempts: ${attempts}`;
        isGuessed.fill(0);

        //end(inputWord);
        if (word === inputWord){
            resetWord();
        }
        else if (attempts === MAX_ATTEMPTS){
            resetWord();
        }

    }
    generateWord();
</script>
</html>
